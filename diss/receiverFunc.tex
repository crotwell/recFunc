
\documentclass[titlepage]{article}
\usepackage{graphicx}
\usepackage{wrapfig}

\begin{document}

\section{Receiver Function Calculation}

Receiver functions determine near receiver earth structure by the strength and timing S waves reverberations generated by a P wave as it interacts with layer boundaries. In addition to the lag zero autocorrelation corresponding to the direct P wave, there are four reverberations with significant energy that appear in a receiver function that correspond to a discontinuity in velocity. They are denoted by Ps, PpPs, PsPs and PpSs. The Ps arrival is an incident P wave that converts to an S wave at the boundary and continues to the surface. The second, PpPs, is an incident P wave that travels across the boundary and to the surface, where it reflects back down to the boundary. At the boundary it reflects again converting into an S wave that travels to the surface. PsPs has a upgoing S wave leg from the boundary to the surface, a downging P wave leg to the boundary and an upgoing S wave leg to the surface. PpSs is almost the same, with the first upgoing and downgoing legs of switching wave types. The final two reverberations arrrive at the same time as they have the same number of P and S wave legs, just reordered. See \ref{fig1} for an illustration of these raypaths.

\begin{wrapfigure}{r}{2.5in} 
\includegraphics[width=2.5in]{figure1.pdf} 
\caption{This is an inserted PDF graphic} 
\label{fig1} 
\end{wrapfigure}

The extraction of the S wave arrivals is possible due to the incident P wave appearing mostly on both the vertical component, while the S wave reverberations are mostly confined to the radial, along with the fact that the wave shape of each reverberation is determined by the source time function of the event and hence should be the same as the initial P wave except for a polarity reversal of PsPs/PpSs. Thus, by deconvolving the vertical from the radial component, the timing and amplitude of the reverberations can be determined. 


\subsection{Iteritive Deconvolution}

The implementation of the iterative deconvolution is based on the iterDecon fortran code of Ammon \cite{iterdecon}. 

The iterative deconvolution begins with the numerator and denominator seismograms, usually the horizontal and verticle respectively, with all preprocessing such as filtering, instrument correction and mean removal already applied. After each seismogram is padded with zeros to the next larger power of two, the given gaussian filter is applied to both. Generally the width of the gaussian is in or around .5 to 5. The gaussian is applied in the frequency domain.

The iteration begins at this point and continues until one of two conditions are meet, either the maximum nummber of iterations are done, or the improvement fromthe previous step is below the tolerence. Within each iteration, the correlation between the current numerator and the denominator is calculated, normalized by the zero lag autocorrelation of the denominator. The largest absolute value of the correlation defines the lag at which the denominator best matches the numerator. The normalized correlation is added to the seismogram of spikes at the corresponding lag time. This spike seismogram is then gaussian filtered and convolved with the denominator to form a prediction of the numerator. The prediction is then subtracted from the numerator. If the power in the numerator, scaled by the denominator, is small enough, the iteration stops. Otherwise it continues until the maximum number of repititions is reached. The spikes, after being gaussian filtered, is the receiver function.


\end{document}