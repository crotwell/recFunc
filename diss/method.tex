
\documentclass[titlepage]{article}

\begin{document}

\section{Receiver Function Calculation}

Receiver functions determine near receiver earth structure by the strength and timing S waves reverberations generated by a P wave as it interacts with layer boundaries. There are four reverberations with significant energy, denoted Ps, PpPs, PsPs and PpSs. The Ps arrival is an incident P wave that converts to an S wave at the boundary and continues to the surface. The second, PpPs, is an incident P wave that travels across the boundary and to the surface, where it reflects back down to the boundary. At the boundary it reflects again converting into an S wave that travels to the surface. PsPs has a upgoing S wave leg from the boundary to the surface, a downging P wave leg to the boundary and an upgoing S wave leg to the surface. PpSs is almost the same, with the first upgoing and downgoing legs of switching wave types. The final two reverberations arrrive at the same time as they have the same number of P and S wave legs, just reordered.

The extraction of the S wave arrivals is possible due to the incident P wave appearing mostly on both the vertical component, while the S wave reverberations are mostly confined to the radial, along with the fact that the wave shape of each reverberation is determined by the source time function of the event and hence should be the same as the initial P wave except for a polarity reversal of PsPs/PpSs. Thus, by deconvolving the vertical from the radial component, the timing and amplitude of the reverberations can be determined. 


\subsection{Iteritive Deconvolution}

The implementation of the iterative deconvolution is based on the iterDecon fortran code of Ammon \cite{iterdecon}. 

The iterative deconvolution begins with the numerator and denominator seismograms, usually the horizontal and verticle respectively, with all preprocessing such as filtering, instrument correction and mean removal already applied. After each seismogram is padded with zeros to the next larger power of two, the given gaussian filter is applied to both. Generally the width of the gaussian is in or around .5 to 5. The gaussian is applied in the frequency domain.

The iteration begins at this point and continues until one of two conditions are meet, either the maximum nummber of iterations are done, or the improvement fromthe previous step is below the tolerence. Within each iteration, the correlation between the current numerator and the denominator is calculated, normalized by the zero lag autocorrelation of the denominator. The largest absolute value of the correlation defines the lag at which the denominator best matches the numerator. The normalized correlation is added to the seismogram of spikes at the corresponding lag time. This spike seismogram is then gaussian filtered and convolved with the denominator to form a prediction of the numerator. The prediction is then subtracted from the numerator. If the power in the numerator, scaled by the denominator, is small enough, the iteration stops. Otherwise it continues until the maximum number of repititions is reached. The spikes, after being gaussian filtered, is the receiver function.

\end{subsection}

\subsection{Determining Crustal Structure}

From the timing of the reverberations, the bulk properties of the crust can be determined. There is of course a tradeoff between thickness of the crust and the velocity of the crust. However, each of the reverberations has a different tradeoff, and hence by analyzing all three phases the correct depth and velocity can be determined.

However, it has been shown ****[REF]*** that the timing of the reverberations is largely insensitive to absolute P and S velocities in the layer, and the best that can be done is to extract the ration of the P to S wave velocity. Therefore a P velocity is usually assumed, and the best combination of crustal thickness and ratio of P to S wave velocity is calculated.

The relative arrival times of the three reverberations with respect to the direct P wave are given by:

$t_{Ps} - t_{P} = H ( \eta_\beta - \eta_\alpha )$

$t_{PpPs} - t_{P} = H ( \eta_\beta + \eta_\alpha )$

$t_{PsPs/PpSs} - t_{P} = 2 H \eta_\beta$

where $\eta_\alpha = \sqrt{1/V_P^2 - p^2}$ and $\eta_\beta = \sqrt{1/V_S^2 - p^2}$ represent the P and S wave vertical slowness respectively.

If the receiver functions are of high quality, then it is possible to simply pick the arrival times of the reverberations and find a best fit of crustal properties. Many studies have done exactly this, ***REF Zandt and Ammon***. However, in making use of noisier stations atop complex structure recording smaller earthquakes, it can be difficult if not impossible to descern these arrivals by eye. In this case, looking at receiver functions from many events at a given station is desirable, which leads to use of a stacking technique.

The simplest stacking technique is to sum the receiver functions. Unless the events are all at similar distances, this is unlikely to generate good results as the timing of the reverberations has a dependence on the ray parameter, which depends on the distance. A slant stack can be used to account for the ray parameter dependence. A further stacking idea to remove the ray parameter dependence is to transform the receiver function, as amplitude as a function of time, to a H\Kappa plot, with amplitude as a function of thickness, H, and $\Kappa = V_p/V_s$. Once this transformation is done, there is no longer a ray parameter dependence, and H\Kappa plots from events at many distances can be summed.

\end{subsection}
\subsection{Phase Stacking}


\end{section}
\end{document}

 